<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta charset="UTF-8">
<style>
canvas {
    border: 1px solid #d3d3d3;
    background-color: #f1f1f1;
}
</style>
</head>
<body onload="startGame()">
<script>
    var player;
    var keys = [];

    function startGame() {
        race.start();
        player = new turtle(100, 300);
    }

    function updateGame() {
        race.clear();
        
        player.speedX = 0;
        player.speedY = 0;
        if (keys[37]) {
            player.speedX = -3; 
        }
        if (keys[39]) {
            player.speedX = 3; 
        }
        if (keys[38]) {
            player.speedY = -3; 
        }
        if (keys[40]) {
            player.speedY = 3; 
        }
        player.move();
        player.update();
    }

    var race  = {
        canvas: document.createElement("canvas"),
        keys: [],
        start: function() {
            this.canvas.width = 800;
            this.canvas.height = 600;
            this.context = this.canvas.getContext("2d");
            document.body.insertBefore(this.canvas, document.body.childNodes[0]);
            this.interval = setInterval(updateGame, 20);
            // window.addEventListener('mouseup', function (e) {
            //     pool.x = e.pageX;
            //     pool.y = e.pageY;
            //     clickAction();
            // })
            // window.addEventListener('touchstart', function (e) {
            //     pool.x = e.pageX;
            //     pool.y = e.pageY;
            // })
            // window.addEventListener('touchend', function (e) {
            //     pool.x = false;
            //     pool.y = false;
            // })
            window.addEventListener('keydown', function (e) {
                keys[e.keyCode] = true;
            })
            window.addEventListener('keyup', function (e) {
                keys[e.keyCode] = false;
            })
        },
        clear : function(){
            this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);
        }
    }

    function turtle(x, y) {
        this.X = x;
        this.Y = y;
        this.speedX = 0;
        this.speedY = 0;
        this.frameSpeed = 15;
        this.currentFrame = 0;
        this.isJumping = false;
        var step1 = new Image();
        var step2 = new Image();
        var idle = new Image();
        step1.src = "./assets/images/turtleL2.png";
        step2.src = "./assets/images/turtleL3.png";
        idle.src = "./assets/images/turtleL.png";
        this.update = function() {
            ctx = race.context;
            if (this.currentFrame >= this.frameSpeed) {
                ctx.drawImage(step1, this.X, this.Y);
                if (this.currentFrame >= (2*this.frameSpeed)) {
                    this.currentFrame = 0;
                }
            } else {
                ctx.drawImage(step2, this.X, this.Y);
            }
            this.currentFrame += 1;
        }
        this.move = function() {
            this.X += this.speedX;
            this.Y += this.speedY;
        }
    }

</script>
</body>
</html>